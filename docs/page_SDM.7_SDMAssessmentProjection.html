<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Assessment &amp; Projection – SDM Workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./images/sdm_favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9859d952baf36b9a7db628bbb9f3169e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">

<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>

<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">

<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>

<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>

<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">

<script src="site_libs/leaflet-binding-2.2.2/leaflet.js"></script>

<script src="site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>

<script src="site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>



<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/sdm_favicon.png" alt="SDM Workshop Logo" class="navbar-logo light-content">
    <img src="./images/sdm_favicon.png" alt="SDM Workshop Logo" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">SDM Workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-spatial-data" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Spatial Data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-spatial-data">    
        <li>
    <a class="dropdown-item" href="./page_SDM.2_SpatialDataR.html">
 <span class="dropdown-text">Spatial Data in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./page_SDM.3_SpeciesData.html">
 <span class="dropdown-text">Species Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./page_SDM.4_EnvironmentalData.html">
 <span class="dropdown-text">Environmental Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./page_SDM.5_PseudoAbsenceData.html">
 <span class="dropdown-text">Background &amp; Pseudo-Absence Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-species-distribution-models" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Species Distribution Models</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-species-distribution-models">    
        <li>
    <a class="dropdown-item" href="./page_SDM.6_SDMSimpleModelFitting.html">
 <span class="dropdown-text">Simple Model Fitting (GLM)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./page_SDM.7_SDMAssessmentProjection.html">
 <span class="dropdown-text">Assessment &amp; Projection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./page_SDM.8_SDMCompareAlgorithms.html">
 <span class="dropdown-text">Fitting &amp; Comparing Algorithms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./page_SDM.9_SDMEnsembleModelFitting.html">
 <span class="dropdown-text">Ensemble Modelling</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link active" data-scroll-target="#model-evaluation">1. Model evaluation</a>
  <ul class="collapse">
  <li><a href="#threshold-independent-evaluation" id="toc-threshold-independent-evaluation" class="nav-link" data-scroll-target="#threshold-independent-evaluation">1.1 Threshold-independent evaluation</a></li>
  <li><a href="#threshold-dependent-evaluation" id="toc-threshold-dependent-evaluation" class="nav-link" data-scroll-target="#threshold-dependent-evaluation">1.2 Threshold-dependent evaluation</a></li>
  </ul></li>
  <li><a href="#projection-across-space-and-time" id="toc-projection-across-space-and-time" class="nav-link" data-scroll-target="#projection-across-space-and-time">2. Projection across space and time</a>
  <ul class="collapse">
  <li><a href="#projecting-the-fitted-glm-across-current-environmental-layers" id="toc-projecting-the-fitted-glm-across-current-environmental-layers" class="nav-link" data-scroll-target="#projecting-the-fitted-glm-across-current-environmental-layers">2.1 Projecting the fitted GLM across current environmental layers</a></li>
  <li><a href="#projecting-under-future-climate-scenarios" id="toc-projecting-under-future-climate-scenarios" class="nav-link" data-scroll-target="#projecting-under-future-climate-scenarios">2.2 Projecting under future climate scenarios</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assessment &amp; Projection</h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<p><br></p>
<p>After a species distribution model (SDM) has been fitted, the next critical steps are to <strong>assess its performance</strong> and <strong>project it across space or time</strong>. Model assessment ensures that the relationships identified between species occurrences and environmental predictors are robust, interpretable, and generalisable and not just artefacts of the training data. Projection then allows us to translate these relationships into maps of habitat suitability, either under current conditions or for future scenarios such as climate change.</p>
<p><strong>Model assessment involves several interconnected steps:</strong><br>
<strong>Model fit</strong>: Examining how well the model explains the training data used to build it. This often involves metrics like deviance or R² computed on the training set.<br>
<strong>Model performance</strong>: Testing the model’s predictions on independent data, i.e.&nbsp;data that were not used in any way during model fitting. This step helps check for overfitting and assess how well the model generalizes. Performance is measured using quantitative metrics to objectively judge model quality.<br>
</p>
<p>This step is crucial in professional applications because <strong><em>good fit does not guarantee good predictions — always test on new data</em></strong>.</p>
<p>A common and recommended approach is to <strong>split the available data into training and testing sets</strong> or use <strong>cross-validation</strong> methods. This ensures that evaluation statistics such as AUC (<em>Area Under the Curve</em>) or TSS (<em>True Skill Statistic</em>) reflect the model’s predictive ability rather than just its capacity to reproduce the training data.</p>
<p>Evaluation metrics fall into two main types:<br>
<strong>Threshold-independent metrics</strong> like AUC and Continuous Boyce Index evaluate the model’s discrimination ability without requiring a binary classification.<br>
<strong>Threshold-dependent metrics</strong>** like sensitivity, specificity, and True Skill Statistic (TSS) require converting continuous predictions into binary outcomes and assess classification accuracy at selected thresholds.<br>
</p>
<p>Together, these evaluation metrics, when applied on validation data, provide a comprehensive picture of model performance.</p>
<p><strong>Projection</strong> extends model application by using fitted relationships to predict species distributions across geographic space, or under different environmental conditions. This is particularly powerful for biodiversity monitoring, invasive species risk mapping, and forecasting impacts of global change. However, projections must always be interpreted in light of uncertainties stemming from data quality, model choice, and environmental scenarios.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Essential SDM Workflow: Fitting, Validating, and Projection
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When building species distribution models (SDMs), it’s essential to distinguish between <strong>model fit</strong>, <strong>model validation</strong>, <strong>model evaluation</strong>, and <strong>final projection</strong>. These are distinct but interconnected steps in a robust modelling workflow.</p>
<hr>
<section id="model-fit" class="level4">
<h4 class="anchored" data-anchor-id="model-fit"><strong>Model fit</strong></h4>
<p>Refers to how well a model explains the data it was <strong>trained on</strong>. This can be assessed using residuals, likelihood measures, or internal performance statistics. However, good fit to training data does <strong>not guarantee predictive accuracy</strong>. Models can overfit, especially with small sample sizes or many predictors.</p>
<hr>
</section>
<section id="model-performance" class="level4">
<h4 class="anchored" data-anchor-id="model-performance"><strong>Model performance</strong></h4>
<p>After fitting a model, it is essential to assess how well it can <strong>generalise to new data</strong>, and not just reproduce the training set. This is typically done by testing the model’s predictions on data that were <em>not</em> used for model fitting.</p>
<p>Common approaches include: - <strong>Data splitting</strong> (e.g., 70% training, 30% testing) - <strong>Cross-validation</strong>, such as k-fold or spatial block cross-validation</p>
<p>Once predictions are made on test data, we assess performance using quantitative evaluation metrics (e.g., AUC, TSS, Boyce index). These metrics quantify how well the model distinguishes presences from absences (or background).</p>
<hr>
</section>
<section id="final-projection" class="level4">
<h4 class="anchored" data-anchor-id="final-projection"><strong>Final projection</strong></h4>
<p>Once the model has been validated and evaluated: - You can <strong>refit the final model using all available data</strong> (training + test) to maximize information. Use this full model to <strong>project species distributions</strong> across space (e.g., habitat suitability maps) or time (e.g., future climate scenarios).</p>
<p><strong>Why refit with all data?</strong><br>
To improve accuracy of projections, especially for rare species or sparse datasets. But remember: this projection step should <strong>only happen after validation</strong> is complete. Together, these steps provide objective evidence of how reliable and useful the model is for prediction, a critical part of any SDM workflow.</p>
<hr>
<p><strong>Best practice workflow summary</strong>:</p>
<ol type="1">
<li><strong>Split</strong> data → for training and validation.<br>
</li>
<li><strong>Fit</strong> model on training data.<br>
</li>
<li><strong>Validate &amp; evaluate</strong> on test data.<br>
</li>
<li><strong>Refit</strong> model on all data.<br>
</li>
<li><strong>Project</strong> using the refitted model.</li>
</ol>
<p>This approach supports both <strong>scientific rigor</strong> and <strong>reliable application</strong> of SDMs in conservation, forecasting, and spatial planning.</p>
</section>
</div>
</div>
</div>
<p><br></p>
<section id="model-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="model-evaluation">1. Model evaluation</h2>
<p>Model evaluation is a key step in SDM analysis. Since SDMs typically predict a continuous probability of occurrence or relative suitability, while field data are often binary (presence vs.&nbsp;absence/pseudo-absence), we need appropriate metrics to judge model quality.</p>
<p>A critical principle in SDM evaluation is to <strong>assess model predictions on independent data</strong> not used during model fitting. This can be achieved by:<br>
<strong>Data splitting</strong>: dividing the dataset into training and testing subsets, fitting the model only on training data, then evaluating on testing data.<br>
<strong>Cross-validation</strong>: repeatedly splitting the data into folds, training on some folds and testing on the others, to obtain robust performance estimates. Evaluating models on independent data helps to avoid overly optimistic assessments caused by overfitting and better reflects how the model will perform in real-world applications.</p>
<p>After a model is fitted, and data have been partitioned appropriately, evaluation metrics are calculated on the validation (test) data to assess predictive performance based on either</p>
<p><strong>Threshold-independent</strong> or <strong>Threshold-dependent</strong> metrics.</p>
<p>Following best-practice, we now split our data into training and testing subsets and refit the GLM model using only the training data before performing any validation.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an index that assign 70% of data to training data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(sdm_df_clean<span class="sc">$</span>pa, <span class="at">p =</span> .<span class="dv">7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sdm_df_train <span class="ot">&lt;-</span> sdm_df_clean[trainIndex, ]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>sdm_df_test <span class="ot">&lt;-</span> sdm_df_clean[<span class="sc">-</span>trainIndex, ]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model on training data</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>glm_multi_train <span class="ot">&lt;-</span> <span class="fu">glm</span>(pa <span class="sc">~</span> <span class="fu">poly</span>(elevation, <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">poly</span>(bio_1, <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">poly</span>(bio_12, <span class="dv">2</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sdm_df_train,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>glm_step_train <span class="ot">&lt;-</span> <span class="fu">step</span>(glm_multi_train , <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="threshold-independent-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="threshold-independent-evaluation">1.1 Threshold-independent evaluation</h3>
<p>The most widely used threshold-independent measure is the <strong>area under the Receiver Operating Characteristic curve (AUC)</strong>. AUC evaluates how well the model distinguishes presences from absences across all possible thresholds. In practical terms, it reflects the probability that a randomly selected presence site will be ranked higher in predicted suitability than a randomly selected absence or background site. An AUC of 0.5 indicates performance no better than random, while values above 0.7 are generally considered acceptable, and values above 0.9 indicate excellent discrimination (<a href="https://doi.org/10.1111/j.1365-2486.2005.01000.x">Araujo et al.&nbsp;2005</a>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>glm_predict_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm_step_train , <span class="at">newdata =</span> sdm_df_test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 'Observed' test data (presence/pseudoabsence)</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>obs_test <span class="ot">&lt;-</span> sdm_df_test<span class="sc">$</span>pa</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate with ROC and AUC on test data</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>roc_glm <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">roc</span>(obs_test, glm_predict_test)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>auc_glm <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">auc</span>(roc_glm)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print AUC</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(auc_glm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8046</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC curve</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_glm, <span class="at">col =</span> <span class="st">"#e31a1c"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"ROC Curve"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="page_SDM.7_SDMAssessmentProjection_files/figure-html/auc-eval-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>How to interpret the ROC curve
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>The <strong>ROC curve</strong> plots <strong>sensitivity</strong> (<em>true positive rate</em>) against <strong>1 – specificity</strong> (<em>false positive rate</em>) across all thresholds.<br>
</li>
<li>A model with no predictive ability follows the diagonal line (AUC ≈ 0.5).<br>
</li>
<li>Curves that <strong>bow towards the upper-left corner</strong> indicate stronger discrimination between presences and absences.<br>
</li>
<li>The <strong>area under the curve (AUC)</strong> provides a summary metric:
<ul>
<li>AUC = 0.5 → random predictions<br>
</li>
<li>0.7 ≤ AUC &lt; 0.8 → fair<br>
</li>
<li>0.8 ≤ AUC &lt; 0.9 → good<br>
</li>
<li>AUC ≥ 0.9 → excellent</li>
</ul></li>
</ul>
<p><em>Note:</em> Always interpret AUC together with ecological reasoning and other evaluation measures<br>
(e.g., TSS, Boyce index), since AUC alone can be misleading if prevalence is unbalanced<br>
or sampling design introduces bias. For example, a model can show a high AUC just by picking up differences between sampled presence and background points, even if those differences don’t reflect true habitat suitability. If sampling is biased — for instance, if presences come mostly from well-surveyed areas — the model may seem accurate but is actually learning where we looked, not where the species occurs.</p>
</div>
</div>
</div>
<p><br></p>
<p>The <strong>Continuous Boyce Index (CBI)</strong> is an evaluation metric used for species distribution models (SDMs) and habitat suitability models that are built using presence-only data.</p>
<p>Unlike AUC, which compares presences to absences or background points, CBI focuses only on how well the model ranks habitat suitability at known presence sites. It evaluates whether the model assigns higher predicted suitability to locations where the species is actually observed, compared to what would be expected by chance. The index ranges from –1 (predictions are worse than random), to 0 (no better than random), to +1 (perfect match between predicted suitability and observed presences). Because CBI is independent of absences or background sampling, it can be more informative than AUC when dealing with biased, incomplete, or presence-only data, making it particularly valuable for large-scale or opportunistic datasets that only report presence records (e.g., museum collections or citizen science data), compared to more detailed field surveys that include both presences and absences.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecospat)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Continuous Boyce Index (CBI)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>boyce_res <span class="ot">&lt;-</span> <span class="fu">ecospat.boyce</span>(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> glm_predict_test,            <span class="co"># model predictions</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs =</span> glm_predict_test[obs_test <span class="sc">==</span> <span class="dv">1</span>],  <span class="co"># predictions at presence points</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nclass =</span> <span class="dv">0</span>,                  <span class="co"># automatic binning</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">window.w =</span> <span class="st">"default"</span>         <span class="co"># default moving window</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"grey50"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="page_SDM.7_SDMAssessmentProjection_files/figure-html/boyce-eval-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracts the continuous Boyce Index value (Spearman correlation)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>boyce_res<span class="sc">$</span>cor</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.901</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>How to interprete the Boyce curve
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>X-axis (suitability):</strong> predicted suitability scores from the SDM.<br>
</li>
<li><strong>Y-axis (predicted/expected ratio):</strong> how much more (or less) frequently presences are found in each suitability class than expected at random.</li>
</ul>
<p><strong>Guidelines:</strong><br>
- A flat line near <strong>1</strong> → model performs no better than random.<br>
- An increasing curve, with ratios <strong>&gt;1</strong> in high suitability bins → good model performance.<br>
- Ratios <strong>&lt;1</strong> in high suitability bins → the model may be misleading.</p>
<p>While P/E ratios in the plot may exceed 1, the Boyce Index correlation ranges from -1 to +1.</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="threshold-dependent-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="threshold-dependent-evaluation">1.2 Threshold-dependent evaluation</h3>
<p>To compute threshold-dependent metrics, we need to choose a threshold that converts continuous probabilities into binary predictions. Several rules exist (see <a href="https://doi.org/10.1111/j.0906-7590.2005.03957.x">Liu et al., 2005</a>), such as:</p>
<ul>
<li>Maximizing sensitivity + specificity</li>
<li>Equal sensitivity and specificity</li>
<li>Fixed probability cutoffs (e.g., 0.5)</li>
</ul>
<p>Here we use the <code>PresenceAbsence</code> package to determine an optimal threshold and then compute metrics like sensitivity, specificity, and the True Skill Statistic (TSS).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PresenceAbsence)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct 'PresenceAbsence' dataframe</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure observed and predicted values are numeric</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>pa_df_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">seq_along</span>(obs_test),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">observed =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(obs_test)),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">predicted =</span> <span class="fu">as.numeric</span>(glm_predict_test)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove any rows with missing values</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>pa_df_test <span class="ot">&lt;-</span> pa_df_test[<span class="fu">complete.cases</span>(pa_df_test), ]</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Find threshold</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>(opt_thresh <span class="ot">&lt;-</span> PresenceAbsence<span class="sc">::</span><span class="fu">optimal.thresholds</span>(</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">DATA=</span> pa_df_test,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">opt.methods =</span> <span class="fu">c</span>(<span class="st">'MaxSens+Spec'</span>, <span class="st">'Sens=Spec'</span>, <span class="st">'MinROCdist'</span>, <span class="st">'MaxKappa'</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Method predicted
1 MaxSens+Spec      0.34
2    Sens=Spec      0.52
3   MinROCdist      0.48
4     MaxKappa      0.34</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use one threshold (e.g., MaxSens+Spec)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    chosen_thresh <span class="ot">&lt;-</span> opt_thresh<span class="sc">$</span>predicted[opt_thresh<span class="sc">$</span>Method <span class="sc">==</span> <span class="st">'MaxSens+Spec'</span>]  </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify predictions</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>pred_binary <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">as.numeric</span>(glm_predict_test) <span class="sc">&gt;=</span> chosen_thresh, <span class="dv">1</span>, <span class="dv">0</span>)    </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Observed =</span> obs_test, <span class="at">Predicted =</span> pred_binary)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Predicted
Observed  0  1
       0 61 41
       1  8 87</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute sensitivity, specificity, TSS</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sensitivity <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred_binary <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> obs_test <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">sum</span>(obs_test <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>specificity <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred_binary <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> obs_test <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sum</span>(obs_test <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>tss <span class="ot">&lt;-</span> sensitivity <span class="sc">+</span> specificity <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">ConfusionMatrix =</span> cm,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">Sensitivity =</span> sensitivity,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">Specificity =</span> specificity,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">TSS =</span> tss)   </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ConfusionMatrix
        Predicted
Observed  0  1
       0 61 41
       1  8 87

$Sensitivity
[1] 0.9157895

$Specificity
[1] 0.5980392

$TSS
[1] 0.5138287</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Choosing thresholds for binary predictions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Species distribution models typically produce <strong>continuous predictions</strong> (relative suitability or probability of occurrence).<br>
To evaluate performance or produce presence/absence maps, these need to be <strong>converted into binary predictions</strong>.<br>
There is no single “best” threshold. Instead, different methods emphasize different trade-offs.</p>
<p>Here are four widely used options:</p>
<ul>
<li><p><strong>MaxSens+Spec</strong><br>
Maximizes the sum of sensitivity (true positive rate) and specificity (true negative rate).<br>
→ Balanced choice when false positives and false negatives are equally costly.</p></li>
<li><p><strong>Sens=Spec</strong><br>
Selects the threshold where sensitivity and specificity are equal.<br>
→ Useful when both error types are equally undesirable.</p></li>
<li><p><strong>MinROCdist</strong><br>
Minimizes the distance between the ROC curve and the perfect classifier point (0,1).<br>
→ Robust option, often similar to MaxSens+Spec but less sensitive to skewed prevalence.</p></li>
<li><p><strong>MaxKappa</strong><br>
Maximizes Cohen’s Kappa statistic, which accounts for agreement expected by chance.<br>
→ Historically popular in ecology, still informative for comparing classifiers.</p></li>
</ul>
<p>It is good practice to report <strong>multiple thresholds</strong>.<br>
This ensures transparency, allows comparison across studies, and lets end-users (e.g., conservation managers) choose the threshold best suited to their objectives (e.g., maximizing detection vs.&nbsp;minimizing false alarms).</p>
</div>
</div>
</div>
</section>
</section>
<section id="projection-across-space-and-time" class="level2">
<h2 class="anchored" data-anchor-id="projection-across-space-and-time">2. Projection across space and time</h2>
<p>Once a species distribution model has been calibrated and evaluated, the next step is projection: predicting habitat suitability across geographic space or future environmental scenarios. Projections enable us to identify potential ranges, assess climate change impacts, and inform conservation planning.</p>
<p>There are two main projection contexts:</p>
<p><strong>Spatial projection</strong>: applying the model to current environmental layers across the study area to produce a habitat suitability map.</p>
<p><strong>Temporal projection</strong>: applying the model to future climate scenarios (e.g., CMIP6 SSPs) to forecast potential range shifts.</p>
<p>::: {.callout-tip collapse=“true” icon=“globe”}<br>
### Important considerations when projecting SDMs</p>
<p>Ensure predictor variables in the projection layers match the model in units, resolution, and extent.</p>
<p>Beware of extrapolation: predictions in environmental space outside the range of training data are uncertain.</p>
<p>For presence–pseudoabsence models, predictions remain relative suitability, not absolute probabilities.</p>
<p>When projecting to future climates, using ensembles of GCMs helps capture uncertainty. :::</p>
<p><br></p>
<section id="projecting-the-fitted-glm-across-current-environmental-layers" class="level3">
<h3 class="anchored" data-anchor-id="projecting-the-fitted-glm-across-current-environmental-layers">2.1 Projecting the fitted GLM across current environmental layers</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare environmental stack for projection</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>proj_stack <span class="ot">&lt;-</span> Env_UK_stack[[<span class="fu">c</span>(<span class="st">"bio_1"</span>, <span class="st">"bio_12"</span>, <span class="st">"elevation"</span>)]]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(proj_stack)  <span class="co"># needs to match predictors in glm_step</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "bio_1"     "bio_12"    "elevation"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict relative suitability across the raster stack</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>glm_suitability_map <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">predict</span>(proj_stack, glm_step, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the predicted suitability</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(glm_suitability_map,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Predicted habitat suitability for R. hipposideros (current)"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">50</span>, <span class="at">option =</span> <span class="st">"D"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="page_SDM.7_SDMAssessmentProjection_files/figure-html/projection_current-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To support conservation decisions or map projected ranges, we often need binary predictions — areas where the species is likely present (1) or absent (0) — instead of continuous suitability values. We’ll now apply a threshold to the predicted suitability map and visualize this binary prediction.</p>
<p>We’ll use the threshold identified earlier (e.g., <em>“MaxSens+Spec”</em>) to reclassify the continuous map.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create binary prediction map: 1 = presence, 0 = absence</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>binary_map <span class="ot">&lt;-</span> glm_suitability_map <span class="sc">&gt;=</span> chosen_thresh</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the binary prediction map</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(binary_map,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Predicted presence/absence of *Rhinolophus hipposideros* (current)"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"lightgrey"</span>, <span class="st">"darkgreen"</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Absence"</span>, <span class="st">"Presence"</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"lightgrey"</span>, <span class="st">"darkgreen"</span>), <span class="at">bty =</span> <span class="st">"n"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="page_SDM.7_SDMAssessmentProjection_files/figure-html/binary-map-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Why binary maps?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Binary SDM outputs are often used in applied contexts — for example:</p>
<p>Estimating species’ range size</p>
<p>Identifying priority conservation areas</p>
<p>Communicating results to decision-makers</p>
<p><em>But</em>: Always interpret binary maps with caution. Thresholding reduces a continuous gradient to a yes/no decision, which can oversimplify ecological reality. That’s why it is recommend:</p>
<p>Reporting both continuous and binary maps</p>
<p>Explaining how the threshold was chosen</p>
<p>Being transparent about limitations</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>View interactive map of projected habitat suitability, presence/absence, and occurrence records
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can also explore an interactive version of the current habitat suitability map and binary map overlaid with occurrence records using <strong>Leaflet</strong>.</p>
<div class="cell">
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-a7b9134d98ecc6a7bce2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a7b9134d98ecc6a7bce2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Esri.WorldImagery",null,"Satellite",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[60.83333333333332,-8.166666666666666],[49.99999999999999,1.749999999999998]],null,"Suitability (continuous)",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.4}]},{"method":"addLegend","args":[{"colors":["#000004 , #430A67 20.1169325867809%, #952667 40.2338651735619%, #DD5239 60.3507977603429%, #FCA70D 80.4677303471238%, #FCFFA4 "],"labels":["0.2","0.4","0.6","0.8"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"numeric","title":"Habitat Suitability","extra":{"p_1":0.2011693258678094,"p_n":0.8046773034712383},"layerId":null,"className":"info legend","group":"Suitability (continuous)"}]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[60.83333333333332,-8.166666666666666],[49.99999999999999,1.749999999999998]],null,"Presence/Absence (binary)",{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.4}]},{"method":"addLegend","args":[{"colors":["lightgrey","darkgreen"],"labels":["Absence","Presence"],"na_color":null,"na_label":"NA","opacity":1,"position":"bottomright","type":"unknown","title":"Presence/Absence","extra":null,"layerId":null,"className":"info legend","group":null}]},{"method":"addCircleMarkers","args":[[52.547661,51.89,51.76,53.323914,51.94,51.6,52.82,50.953602,52.076527,52.48,52.08,52.610815,51.136191,51.114355,50.74,50.822624,53.2,50.701981,51.94,51.99,51.83,51.53,52,51.94,51.99,51.84,51.98,51.812603,52.67,51.01591,51.950728,51.95,51.922428,51.96,51.1,52.14,51.180535,52.57,51.110205,52.04,51.87,50.987048,51.790912,51.95,52.04,51.84,52.09,52.009608,51.94,51.66,52.11,51.651088,51.92,52.369174,51.84,51.19,51.828561,50.88,53.349345,53.347074,51.795979,51.707139,52.013228,51.651979,51.738667,51.225024,54.277149,50.886816,51.87,51.743504,51.545213,51.740991,51.741885,51.990914,52.80294,51.836907,52.088702,52.578332,52.748316,51.980882,52.749032,52.04,50.980485,51.128329,52.286943,52.01287,53.257235,52.794108,53.175293,52.785206,51.919976,49.99616,52.125272,52.902204,53.034311,53.160734,51.791126,51.121381,53.164427,50.082842,51.341987,53.181682,50.74704,52.758717,53.136988,53.064656,51.717385,51.611159,52.650528,51.792519,52.080585,52.843661,53.116474,50.135113,53.119244,52.062137,52.035166,50.853701,53.172469,53.236042,51.618784,52.073605,50.394307,52.703393,53.252861,50.566117,53.09229,51.557516,52.710897,52.242378,51.745535,52.064778,53.161407,51.189201,50.935434,53.056351,51.160744,51.575486,51.610348,53.074321,52.787023,53.262311,53.065336,53.227058,53.047086,53.08308,53.265967,52.541429,53.089839,52.757785,51.583666,51.575219,52.803173,52.963937,52.749962,50.83455,53.153676,51.252616,52.728865,51.78,51.224321,52.1246,52.12,52.55,51.73563,51.719286,51.665425,50.358561,51.710378,52.04,51.92,51.22,51.051108,52.36,51.31,51.23,51.231981,51.555857,52.05,51.91,51.44,51.462254,50.737288,52.945231,51.733844,51.819636,51.98,51.827127,50.659826,51.016502,51.915397,53.261574,51.889356,53.176798,52.102219,52.013406,51.892766,52.995556,52.28202,53.085425,51.922413,52.835381,53.259498,53.069686,51.739918,51.62,51.57,50.750945,53.167395,51.632398,50.38157,50.471459,52.71817,51.829816,51.175199,51.979153,52.09,52.895445,52.650197,52.09,51.918454,51.71,52.725941,53.169651,50.89,51.83179,51.833413,51.91,52.911481,51.494609,52.641967,52.739811,51.828846,51.878962,51.896819,51.550002,51.399856,51.212823,51.72,52.075633,52.887071,52.98771,52.803009,51.21,51.27,51.314193,51.81,51.87,51.647347,51.173314,51.97,51.919713,50.71,51.043932,51.561184,52.072381,51.552131,51.645744,51.776163,51.819173,51.722241,52.28129,51.84,51.67,51.923321,51.885767,51.23,51.909822,50.4,50.57,52.560207,51.656006,51.215182,53.043038,52.23,51.825514,51.91,52.062493,52.07958,52.068949,51.84,52.715766,52.106926,52.06,51.830892,51.96,52.09,51.94,53.036224,51.271408,50.45,51.724918,51.371582,51.297076,51.817274,51.814649,50.752844,51.737238,52.021126,52.34,51.281193,52.815814,50.834976,51.107971,52.637542,50.548506,52.636066,50.078551,52.814143,50.351815,51.021728,50.455589,52.808018,52.543769,51.225191,50.751981,51.799557,51.83359,50.452349,50.844326,50.928167,51.716354,52.625924,51.26322,50.149288,50.445359,53.341966,51.542554,52.905686,53.375925,53.077553,51.219543,50.372945,51.79,52.883909,52.805606,51.891318,52.993874,52.04,52.15214,51.882,51.185288,52.985282,52.900099,51.211252,50.738049,50.729057,51.94,51.922954,51.188814,51.35,51.953412,51.81,51.82,50.47],[-3.107454,-3.28,-3.57,-4.120514,-3.38,-3.51,-3.42,-1.893304,-2.283168,-2.26,-2.28,-2.977668,-2.644768,-2.740908,-2.84,-2.77197,-3.2,-3.127383,-1.55,-1.48,-3.27,-3.74,-1.6,-3.3,-2.96,-2.67,-3.41,-3.085016,-3.28,-2.404751,-2.573126,-2.57,-1.492472,-3.32,-3.87,-1.67,-2.767275,-3.26,-2.759085,-3.08,-2.58,-4.359357,-2.385113,-3.39,-1.93,-3.1,-2.52,-2.94842,-2.46,-2.65,-2.32,-2.796373,-2.63,-2.956105,-2.66,-2.28,-3.089724,-4.43,-3.729059,-3.879199,-4.974272,-2.610432,-1.782855,-2.651843,-3.08756,-2.243792,-0.881784,-3.941958,-1.39,-1.784149,-4.092461,-2.797953,-2.653137,-1.90675,-3.892733,-2.531146,-2.519537,-3.189395,-3.934814,-2.503728,-3.890395,-2.32,-2.908921,-2.605883,-2.404572,-1.637153,-3.875257,-4.596918,-3.273175,-3.877134,-3.375487,-5.175676,-1.643545,-4.372886,-4.037085,-3.369965,-2.690096,-3.223029,-4.297569,-5.293253,-2.611543,-3.81958,-2.844715,-3.846355,-3.80274,-3.829567,-2.949531,-4.174933,-3.161789,-2.385631,-1.746048,-4.59245,-3.30879,-5.35283,-3.787054,-2.417123,-2.416872,-3.002912,-3.834152,-3.791917,-4.247528,-3.307249,-4.315723,-3.266793,-3.867571,-4.691313,-3.785936,-4.157945,-4.021982,-1.730481,-2.790791,-3.292403,-3.310157,-3.568263,-2.90505,-3.784449,-2.83795,-4.158796,-4.218224,-4.307697,-3.758576,-3.837995,-3.784821,-3.791541,-4.321161,-3.800486,-3.583244,-3.940448,-3.278116,-3.223916,-4.202489,-4.173216,-3.180689,-3.944432,-3.831167,-3.130309,-3.190285,-2.495725,-4.022813,-3.36,-3.895771,-3.263791,-3.26,-2.19,-3.377122,-2.674525,-2.659266,-3.79378,-2.659919,-1.85,-2.79,-3.9,-2.265902,-2.12,-2.14,-2.23,-2.341819,-3.371684,-1.54,-2.59,-3.6,-3.656783,-2.943738,-3.988244,-3.521882,-1.660468,-1.75,-3.2348,-3.062442,-3.355705,-3.382616,-3.575586,-4.83509,-3.123594,-2.512394,-1.928559,-4.689951,-3.26788,-2.514466,-3.27052,-2.510343,-4.101994,-3.725431,-4.314912,-2.942762,-4.22,-4.12,-2.92275,-3.871337,-4.240976,-3.759483,-3.762819,-3.852044,-2.944638,-3.040283,-4.84076,-1.79,-4.008264,-4.165751,-2.21,-3.0919,-1.68,-3.260043,-3.721823,-3.95,-2.654437,-1.78372,-3.34,-4.35852,-3.59313,-3.117225,-3.90481,-1.747464,-2.981987,-2.996909,-3.804204,-3.816864,-3.937849,-2.6,-4.554992,-4.453818,-3.863558,-4.152357,-3.94,-2.23,-2.483211,-2.56,-2.69,-3.229908,-3.191358,-1.65,-2.946524,-2.13,-3.334922,-2.794801,-4.70074,-3.660047,-3.374396,-3.371108,-2.472906,-4.245418,-2.661041,-2.64,-2.65,-1.783288,-4.9802,-3.87,-1.776085,-4.31,-4.7,-3.203656,-2.731408,-2.767351,-4.052415,-2.08,-3.379862,-1.83,-2.300435,-2.548615,-4.84646,-1.4,-3.999998,-2.461344,-1.7,-2.799542,-1.67,-2.34,-1.65,-4.063032,-2.237904,-4.34,-4.100751,-2.525803,-2.503439,-3.959953,-2.480112,-2.63927,-3.232347,-4.777823,-2.5,-2.579152,-3.262641,-3.49245,-3.215533,-3.109723,-4.471496,-3.257458,-5.285969,-3.410971,-5.164214,-2.785539,-4.60754,-3.855862,-3.040998,-2.429904,-2.781013,-4.82945,-1.928842,-4.748247,-2.214418,-3.210839,-4.53468,-3.995898,-2.451802,-5.357722,-5.02958,-4.179415,-4.236558,-3.265254,-4.016806,-3.867437,-1.891826,-5.191959,-2.63,-4.602284,-4.00412,-2.415539,-3.416825,-1.68,-2.388733,-5.125279,-3.528526,-4.01243,-3.711115,-2.767944,-2.844553,-2.844391,-3.34,-2.364937,-3.59687,-2.54,-2.615284,-3.15,-2.65,-4.57],5,null,"Cleaned points",{"interactive":true,"className":"","stroke":true,"color":"black","weight":1,"opacity":0.5,"fill":true,"fillColor":"#e31a1c","fillOpacity":0.9},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Suitability (continuous)","Presence/Absence (binary)"],"Cleaned points",{"collapsed":false,"autoZIndex":true,"position":"topright"}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]}],"limits":{"lat":[49.99616,60.83333333333332],"lng":[-8.166666666666666,1.749999999999998]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="projecting-under-future-climate-scenarios" class="level3">
<h3 class="anchored" data-anchor-id="projecting-under-future-climate-scenarios">2.2 Projecting under future climate scenarios</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># First, generate a raster stack for future climate and elevation data</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Resample Elev_UK raster to match Clim_cmip6_2041_2060_UK raster</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>Elev_UK_aligned_future <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">resample</span>(Elev_UK, Clim_cmip6_2041_2060_UK, <span class="at">method =</span> <span class="st">"bilinear"</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Crop to common extent</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>common_extent_future <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">intersect</span>(terra<span class="sc">::</span><span class="fu">ext</span>(Clim_cmip6_2041_2060_UK), terra<span class="sc">::</span><span class="fu">ext</span>(Elev_UK_aligned_future))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>Clim_UK_future_crop2 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">crop</span>(Clim_cmip6_2041_2060_UK, common_extent_future)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>Elev_UK_future_crop2 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">crop</span>(Elev_UK_aligned_future, common_extent_future)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack layers and name variables</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>Env_UK_stack_future <span class="ot">&lt;-</span> <span class="fu">c</span>(Clim_UK_future_crop2 , Elev_UK_future_crop2)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Env_UK_stack_future) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sub</span>(<span class="st">"^wc2</span><span class="sc">\\</span><span class="st">.1_10m_"</span>, <span class="st">""</span>, <span class="fu">names</span>(Clim_UK_crop2)), <span class="st">"elevation"</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: future CMIP6 scenario (SSP5-8.5, 2041-2060)</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>future_stack <span class="ot">&lt;-</span>  Env_UK_stack_future[[<span class="fu">c</span>(<span class="st">"bio_1"</span>, <span class="st">"bio_12"</span>, <span class="st">"elevation"</span>)]]</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(future_stack) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bio_1"</span>, <span class="st">"bio_12"</span>, <span class="st">"elevation"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict future relative suitability</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>future_suitability <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">predict</span>(future_stack, glm_step, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot future suitability</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(future_suitability,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Projected habitat suitability under CMIP-6 (2041-2060)"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">50</span>, <span class="at">option =</span> <span class="st">"E"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="page_SDM.7_SDMAssessmentProjection_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Literature
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Araujo, M. B., Pearson, R. G., Thuiller, W., &amp; Erhard, M. (2005). <strong>Validation of species-climate impact models under climate change.</strong> <em>Global Change Biology</em>, 11(9), 1504–1513. <a href="https://doi.org/10.1111/j.1365-2486.2005.01000.x">doi:10.1111/j.1365-2486.2005.001000.x</a></p>
<p>Hirzel, A. H., Le Lay, G., Helfer, V., Randin, C., &amp; Guisan, A. (2006). <strong>Evaluating the ability of habitat suitability models to predict species presences.</strong> <em>Ecological Modelling</em>, 199(2), 142–152. <a href="https://doi.org/10.1016/j.ecolmodel.2006.05.017">doi:10.1016/j.ecolmodel.2006.05.017</a></p>
<p>Liu, C., Berry, P. M., Dawson, T. P., &amp; Pearson, R. G. (2005). <strong>Selecting thresholds of occurrence in the prediction of species distributions.</strong> <em>Ecography</em>, 28(3), 385–393. doi: <a href="https://doi.org/10.1111/j.0906-7590.2005.03957.x">doi:10.1111/j.0906-7590.2005.03957.x</a></p>
<p>Smith, A. B., &amp; Santos, M. J. (2020). <strong>Testing the ability of species distribution models to infer variable importance.</strong> <em>Ecography</em>, 43(12), 1801–1813. [doi:10.1111/ecog.05317] (https://doi.org/10.1111/ecog.05317)</p>
<p>Wilson, K. A., Westphal, M. I., Possingham, H. P., &amp; Elith, J. (2005). <strong>Sensitivity of conservation planning to different approaches to using predicted species distribution data.</strong> <em>Biological Conservation</em>, 122(1), 99–112.</p>
<p>Zurell, D., Franklin, J., König, C., Bouchet, P.J., Dormann, C.F., Elith, J., Fandos, G., Feng, X., Guillera-Arroita, G., Guisan, A., Lahoz-Monfort, J.J., Leitão, P.J., Park, D.S., Peterson, A.T., Rapacciuolo, G., Schmatz, D.R., Schröder, B., Serra-Diaz, J.M., Thuiller, W., Yates, Katherine L., Zimmermann, Niklaus E. &amp; Merow, C. (2020). <strong>A standard protocol for reporting species distribution models.</strong> <em>Ecography</em>, 43(9), 1261–1277. <a href="https://doi.org/10.1111/ecog.04960">doi:10.1111/ecog.04960</a></p>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/konswells1\.github\.io\/SDM-Workshop");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://konswells1.github.io">Konstans Wells</a>, Swansea University, 2025</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>License: <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></p>
</div>
  </div>
</footer>




</body></html>